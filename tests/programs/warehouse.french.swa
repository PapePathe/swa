dialecte:fran√ßais;
//
// ---------------------------------------------------------
// DOMAIN MODELS
// ---------------------------------------------------------

structure Dimensions {
    Length: decimal,
    Width: decimal,
    Height: decimal,
}

structure Item {
    SKU: chaine,
    Weight: decimal,
    Dim: Dimensions,
    Quantity: entier,
    Price: decimal,
}

structure Bin {
    Id: entier,
    Items: [5]Item,
    ItemCount: entier,
}

structure Aisle {
    Letter: chaine,
    Bins: [10]Bin,
}

structure Warehouse {
    Location: chaine,
    Aisles: [3]Aisle,
    Capacity: decimal,
}

structure Truck {
    ID: entier,
    MaxWeight: decimal,
    CurrentWeight: decimal,
    IsFull: entier,
}

// ---------------------------------------------------------
// CALCULATION HELPERS
// ---------------------------------------------------------

fonction calculateVolume(d: Dimensions) decimal {
    retourner d.Length * d.Width * d.Height;
}

fonction calculateShippingCost(weight: decimal, distance: entier, priority: entier) decimal {
    // Math Coercion: decimal * entier * entier
    variable base: decimal = weight * 0.5;
    variable distCharge: decimal = distance * 0.15;
    variable priorityMultiplier: decimal = 1.0;
    
    si (priority == 1) {
        priorityMultiplier = 1.5;
    }
    
    retourner (base + distCharge) * priorityMultiplier;
}

// ---------------------------------------------------------
// WAREHOUSE OPERATIONS
// ---------------------------------------------------------

fonction initializeWarehouse(wh: *Warehouse) entier {
    wh.Location = "Central Hub - Paris";
    wh.Capacity = 5000.0;
    
    // Demonstrates deep indexing in loops
    variable a: entier = 0;
    tantque (a < 3) {
        si (a == 0) { wh.Aisles[a].Letter = "A"; }
        si (a == 1) { wh.Aisles[a].Letter = "B"; }
        si (a == 2) { wh.Aisles[a].Letter = "C"; }
        
        variable b: entier = 0;
        tantque (b < 10) {
            wh.Aisles[a].Bins[b].Id = (a * 10) + b;
            wh.Aisles[a].Bins[b].ItemCount = 0;
            b = b + 1;
        }
        a = a + 1;
    }
    retourner 1;
}

fonction addItem(wh: *Warehouse, aisleIdx: entier, binIdx: entier, item: Item) entier {
    variable count: entier = wh.Aisles[aisleIdx].Bins[binIdx].ItemCount;
    
    si (count >= 5) {
        afficher("Bin %d in Aisle %s is full!\n", binIdx, wh.Aisles[aisleIdx].Letter);
        retourner -1;
    }
    
    // Struct injection into nested array element
    wh.Aisles[aisleIdx].Bins[binIdx].Items[count] = item;
    wh.Aisles[aisleIdx].Bins[binIdx].ItemCount = count + 1;
    
    retourner 0;
}

// ---------------------------------------------------------
// TRUCK LOADING LOGIC
// ---------------------------------------------------------

fonction loadTruck(t: *Truck, item: Item) entier {
    si (t.CurrentWeight + item.Weight > t.MaxWeight) {
        t.IsFull = 1;
        retourner -1;
    }
    
    t.CurrentWeight = t.CurrentWeight + item.Weight;
    afficher("Truck %d: Loaded SKU %s. Current Weight: %.2f\n", t.ID, item.SKU, t.CurrentWeight);
    retourner 1;
}

// ---------------------------------------------------------
// MAIN EXECUTION (ENTRY POINT)
// ---------------------------------------------------------

demarrer() entier {
    afficher("=== LOGISTICS SYSTEM INITIALIZING ===\n");

    // 1. Setup Warehouse
    variable myWarehouse: Warehouse = Warehouse{}; // Default initialization (zero-values)
    initializeWarehouse(myWarehouse);
    afficher("Warehouse %s initialized.", myWarehouse.Location);

    // 2. Create Stock Items
    variable laptop: Item = Item{
        SKU: "LAP-001", 
        Weight: 2.5, 
        Dim: Dimensions{Length: 35.0, Width: 25.0, Height: 2.0},
        Quantity: 10,
        Price: 1200.0
    };

    variable monitor: Item = Item{
        SKU: "MON-99", 
        Weight: 5.2, 
        Dim: Dimensions{Length: 60.0, Width: 40.0, Height: 15.0},
        Quantity: 5,
        Price: 350.0
    };

    // 3. Stock the Warehouse (Testing Deep GEP)
    addItem(myWarehouse, 0, 0, laptop);
    addItem(myWarehouse, 0, 0, laptop);
    addItem(myWarehouse, 1, 5, monitor);

    // 4. Inventory Audit Logic
    afficher("--- INVENTORY AUDIT ---\n");
    variable totalValue: decimal = 0.0;
    variable i: entier = 0;
    tantque (i < 3) {
        variable j: entier = 0;
        tantque (j < 10) {
            variable k: entier = 0;
            variable currentBin: Bin = myWarehouse.Aisles[i].Bins[j];
            tantque (k < currentBin.ItemCount) {
                variable it: Item = currentBin.Items[k];
                afficher("Aisle %s-Bin %d: SKU %s found.", myWarehouse.Aisles[i].Letter, j, it.SKU);
                totalValue = totalValue + it.Price;
                k = k + 1;
            }
            j = j + 1;
        }
        i = i + 1;
    }
    afficher("Total Asset Value in Warehouse: $%.2f\n", totalValue);

    // 5. Fleet Management
    variable deliveryTruck: Truck = Truck{ID: 501, MaxWeight: 100.0, CurrentWeight: 0.0, IsFull: 0};
    
    // Load truck from warehouse stock
    loadTruck(deliveryTruck, myWarehouse.Aisles[0].Bins[0].Items[0]);
    loadTruck(deliveryTruck, myWarehouse.Aisles[1].Bins[5].Items[0]);

    // 6. Calculate Route Costs
    variable shippingFee: decimal = calculateShippingCost(deliveryTruck.CurrentWeight, 250, 1);
    afficher("Shipment Cost for 250km (Priority): $%.2f\n", shippingFee);

    afficher("=== SYSTEM SHUTDOWN ===");
    retourner 0;
}
